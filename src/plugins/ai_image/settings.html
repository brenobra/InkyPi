<div class="form-group">
    <label for="textPrompt" class="form-label">Text Prompt:</label>
    <input type="text" id="textPrompt" name="textPrompt" placeholder="Describe the image you want to generate..." required class="form-input">
    <small class="form-help">Describe what you want to see in the image</small>
</div>

<!-- Style Selection -->
<div class="form-group">
    <label for="styleOption" class="form-label">Style Option:</label>
    <select id="styleOption" name="styleOption" class="form-input">
        <!-- Options will be populated by JavaScript -->
    </select>
    <small class="form-help" id="styleDescription">Style description will appear here</small>
</div>

<!-- Model Selection -->
<div class="form-group">
    <label for="imageModel" class="form-label">AI Model:</label>
    <select id="imageModel" name="imageModel" class="form-input">
        <!-- Options will be populated by JavaScript -->
    </select>
    <small class="form-help" id="modelDescription">Model description will appear here</small>
</div>

<!-- Grayscale Conversion Option -->
<div class="form-group">
    <label class="form-label">
        <input type="checkbox" id="convertToGrayscale" name="convertToGrayscale">
        Convert to Grayscale
    </label>
    <small class="form-help">Convert generated image to black and white for better contrast on monochrome displays</small>
</div>


<script>
    // Data will be passed from the backend
    const styleOptions = {{ style_options | tojson }};
    const imageModels = {{ image_models | tojson }};

    function updateStyleDescription() {
        const styleSelect = document.getElementById('styleOption');
        const descriptionElement = document.getElementById('styleDescription');
        const selectedStyleId = styleSelect.value;
        
        const selectedStyle = styleOptions.find(style => style.id === selectedStyleId);
        if (selectedStyle) {
            descriptionElement.textContent = selectedStyle.description;
        }
    }

    function updateModelDescription() {
        const modelSelect = document.getElementById('imageModel');
        const descriptionElement = document.getElementById('modelDescription');
        const selectedModelId = modelSelect.value;
        
        const selectedModel = imageModels.find(model => model.id === selectedModelId);
        if (selectedModel) {
            descriptionElement.textContent = selectedModel.description;
        }
    }

    // Populate form values from plugin settings
    document.addEventListener('DOMContentLoaded', () => {
        const styleSelect = document.getElementById('styleOption');
        const modelSelect = document.getElementById('imageModel');
        
        // Populate style dropdown
        styleOptions.forEach(style => {
            const option = document.createElement('option');
            option.value = style.id;
            option.textContent = style.name;
            styleSelect.appendChild(option);
        });
        
        // Populate model dropdown
        imageModels.forEach(model => {
            const option = document.createElement('option');
            option.value = model.id;
            option.textContent = model.name;
            modelSelect.appendChild(option);
        });
        
        // Set up change handlers
        styleSelect.addEventListener('change', updateStyleDescription);
        modelSelect.addEventListener('change', updateModelDescription);
        
        if (loadPluginSettings) {
            // Load saved settings
            document.getElementById('textPrompt').value = pluginSettings.textPrompt || '';
            
            // Set selected style (default to 'none')
            const savedStyle = pluginSettings.styleOption || 'none';
            styleSelect.value = savedStyle;
            
            // Set selected model
            const savedModel = pluginSettings.imageModel || '@cf/black-forest-labs/flux-1-schnell';
            modelSelect.value = savedModel;
            
            // Set grayscale conversion (default to false for color preservation)
            document.getElementById('convertToGrayscale').checked = pluginSettings.convertToGrayscale || false;
        } else {
            // Set defaults
            styleSelect.value = 'none';
            modelSelect.value = '@cf/black-forest-labs/flux-1-schnell';
            document.getElementById('convertToGrayscale').checked = false;
        }
        
        // Update descriptions for initially selected options
        updateStyleDescription();
        updateModelDescription();
    });
</script>
