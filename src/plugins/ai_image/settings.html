<div class="form-group">
    <label for="textPrompt" class="form-label">Text Prompt:</label>
    <input type="text" id="textPrompt" name="textPrompt" placeholder="Describe the image you want to generate..." required class="form-input">
    <small class="form-help">E-ink optimizations will be automatically added to your prompt</small>
</div>

<!-- Model Selection -->
<div class="form-group">
    <label for="imageModel" class="form-label">AI Model:</label>
    <select id="imageModel" name="imageModel" class="form-input">
        <!-- Options will be populated by JavaScript -->
    </select>
    <small class="form-help" id="modelDescription">Model description will appear here</small>
</div>


<script>
    // Model data will be passed from the backend
    const imageModels = {{ image_models | tojson }};

    function updateModelDescription() {
        const modelSelect = document.getElementById('imageModel');
        const descriptionElement = document.getElementById('modelDescription');
        const selectedModelId = modelSelect.value;
        
        const selectedModel = imageModels.find(model => model.id === selectedModelId);
        if (selectedModel) {
            descriptionElement.textContent = selectedModel.description;
        }
    }

    // Populate form values from plugin settings
    document.addEventListener('DOMContentLoaded', () => {
        const modelSelect = document.getElementById('imageModel');
        
        // Populate model dropdown
        imageModels.forEach(model => {
            const option = document.createElement('option');
            option.value = model.id;
            option.textContent = model.name;
            modelSelect.appendChild(option);
        });
        
        // Set up change handler
        modelSelect.addEventListener('change', updateModelDescription);
        
        if (loadPluginSettings) {
            // Load saved settings
            document.getElementById('textPrompt').value = pluginSettings.textPrompt || '';
            
            // Set selected model
            const savedModel = pluginSettings.imageModel || '@cf/black-forest-labs/flux-1-schnell';
            modelSelect.value = savedModel;
        } else {
            // Set default model
            modelSelect.value = '@cf/black-forest-labs/flux-1-schnell';
        }
        
        // Update description for initially selected model
        updateModelDescription();
    });
</script>
